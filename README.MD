# Customer Management API

Este projeto Ã© uma API serverless para gerenciamento de clientes, implementada usando AWS Lambda, API Gateway e DynamoDB. A aplicaÃ§Ã£o fornece operaÃ§Ãµes CRUD completas para gerenciar informaÃ§Ãµes de clientes.

##  Tecnologias

- Node.js (v22.x)
- TypeScript
- AWS Lambda
- Amazon DynamoDB
- AWS API Gateway
- Jest para testes

##  Requisitos

- Node.js v22.x
- AWS CLI configurado
- DynamoDB Local (para desenvolvimento)
- TypeScript

##  Estrutura do Projeto

```
project/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ handlers/
â”‚   â”‚   â”œâ”€â”€ createCustomer.ts
â”‚   â”‚   â”œâ”€â”€ getCustomer.ts
â”‚   â”‚   â”œâ”€â”€ updateCustomer.ts
â”‚   â”‚   â””â”€â”€ deleteCustomer.ts
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ Customer.ts
â”‚   â”œâ”€â”€ repositories/
â”‚   â”‚   â””â”€â”€ CustomerRepository.ts
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ CustomerService.ts
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ validator.ts
â”‚   â”‚   â””â”€â”€ errors.ts
â”‚   â”œâ”€â”€ tests/
â”‚   â””â”€â”€ index.ts
â””â”€â”€ package.json
```

##  InstalaÃ§Ã£o


2. Instale as dependÃªncias:
```bash
npm install
```

3. Configure as variÃ¡veis de ambiente:
```bash
cp .env.example .env
```

4. Configure o DynamoDB Local:
```bash
docker run -p 8000:8000 amazon/dynamodb-local
```

5. Crie a tabela no DynamoDB Local:
```bash
aws dynamodb create-table \
  --table-name Customers \
  --attribute-definitions AttributeName=id,AttributeType=S \
  --key-schema AttributeName=id,KeyType=HASH \
  --provisioned-throughput ReadCapacityUnits=5,WriteCapacityUnits=5 \
  --endpoint-url http://localhost:8000
```

## ðŸ“¦ Estrutura do Cliente

```typescript
interface Customer {
  id: string;
  name: string;
  birthDate: string; /* Formato: YYYY-MM-DD */
  isActive: boolean;
  addresses: string[];
  contacts: {
    email: string;
    phone: string;
    isPrimary: boolean;
  }[];
}
```

##  Endpoints da API

### Criar Cliente
```http
POST /customers

{
  "name": "JoÃ£o Silva",
  "birthDate": "1990-01-01",
  "isActive": true,
  "addresses": ["Rua A, 123"],
  "contacts": [
    {
      "email": "joao@email.com",
      "phone": "11999999999",
      "isPrimary": true
    }
  ]
}
```

### Buscar Cliente
```http
GET /customers/{id}
```

### Atualizar Cliente
```http
PUT /customers/{id}

{
  "name": "JoÃ£o Silva Atualizado",
  "isActive": false
}
```

### Deletar Cliente
```http
DELETE /customers/{id}
```

##  Testes

Execute os testes unitÃ¡rios:
```bash
npm test
```

Para ver a cobertura de testes:
```bash
npm run test:coverage
```

##  Deploy

1. Construa o projeto:
```bash
npm run build
```

2. FaÃ§a o deploy usando o AWS SAM ou diretamente pelo console da AWS:
```bash
sam deploy
```

## VariÃ¡veis de Ambiente

```env
AWS_REGION=us-east-1
CUSTOMERS_TABLE=Customers
IS_OFFLINE=true # apenas para desenvolvimento local
```

## Desenvolvimento Local

1. Inicie o DynamoDB Local:
```bash
docker start dynamodb-local
```

2. Configure as variÃ¡veis de ambiente para desenvolvimento local:
```bash
export IS_OFFLINE=true
export AWS_REGION=us-east-1
export CUSTOMERS_TABLE=Customers
```

3. Execute os testes para verificar se tudo estÃ¡ funcionando:
```bash
npm test
```

##  ValidaÃ§Ãµes

O sistema inclui as seguintes validaÃ§Ãµes:
- Nome nÃ£o pode ser vazio
- Data de nascimento deve estar no formato YYYY-MM-DD
- Pelo menos um endereÃ§o Ã© obrigatÃ³rio
- Pelo menos um contato deve ser marcado como principal
- Email deve ser vÃ¡lido
- Telefone deve ser vÃ¡lido (10-11 dÃ­gitos)

##  Status Codes

- 200: Sucesso
- 201: Criado com sucesso
- 204: Deletado com sucesso
- 400: Erro de validaÃ§Ã£o
- 404: Recurso nÃ£o encontrado
- 500: Erro interno do servidor
